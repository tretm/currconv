# currconv

# Задача:
 Разработать сервис конвертации валют.

Сервис должен уметь:
1. Собирать и парсить данные минимум из одного указанного источника;
2. Иметь открытое API для приема http запросов. (GUI не требуется)

Список API routes:
1. Запрос списка курсов ЦБ определенной страны;
2. Зарос на конвертацию из одной валюты в другую. В запросе можно указать страну, ЦБ которой выступит источником курсов. Если страна не указана, то берется дефолтная страна/источник.

Источники курсов:
1. ЦБ Тайланда: https://www.bot.or.th/App/RSS/fxrate-all.xml
2. ЦБ России: http://www.cbr.ru/scripts/XML_daily.asp

Дополнительно:
- При разработке архитектуры сервиса учесть, что может быть добавлена еще одна страна со своим ЦБ в качестве источника данных, при этом формат данных может отличаться от xml, например json;
- Учесть, что источники курсов могут иметь ограничение на количество запросов в секунду, что при большом количестве обращений к сервису потенциально делает невозможным real-time получение курсов по факту запроса на конвертацию.

# Решение:
Сервис разделен на 3 части:
 - хранилище данных; 
 - парсер источников курсов;
 - http server, обрабатывающий запросы на получение списка курсов валют определеной страны, а так же запрос на конвертацию валюты.
 Хранилище данных представляет собой интерфейс, в данной задаче реализовано через тип map (по условиям задания не требовалось использование баз данных, и долгосрочного хранения курсов валют). 
 Для входящих запрсов на сервер, используется библеотека gorilla/mux.
 Парсер источников данных написан с использованием стандартных библеотек языка go, имеет универсальную функцию, вызов которой позволяет извлечь данные из источника данных, имеющего свою реализацию в коде.
 
# API сервиса конвертации валют.
1.  Запрос списка курсов ЦБ определенной страны.
 Реализован через метод GET, в URL запроса указывается двухбуквенный код страны, например ```http://localhost:8080/listcurrency/th``` или ```http://localhost:8080/listcurrency/ru```
  
 Пример выполнения ```curl -X GET http://localhost:8080/listcurrency/ru```
 
 Ответ на запрос возвращается в формате json 
 ```json
 [AED:{19.8182 19.8182} AMD:{0.1842 0.1842} AUD:{50.3941 50.3941}...]
 ```
 
 2. Зарос на конвертацию из одной валюты в другую.
Реализован через метод POST. Запрос принимает входные данные в формате json, не обязательные параметры country и Amount.  
```json 
{"from":"usd", "to":"rub","country":"th","Amount":0}'
``` 
Ответ на запрос возвращается в формате json. Пример: 
```json 
{"amout":1.0708}
```
 
Пример выполнения ```http://localhost:8080/currencyconverter -H 'Content-Type: application/json' -d '{"from":"usd", "to":"rub","country":"th","Amount":0}'```

# Установка

```
 go install github.com/tretm/currconv@latest 
```

